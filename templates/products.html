{% extends "base.html" %}

{% block content %}
<div class="page_heading_text">
    <h1>Products page </h1>
</div>

<div class="gallery">

    <div class="gallery-item">
      <a target="_blank" href="static\images\dam.jpg">
        <img src="static\images\dam.jpg" alt="Cinque Terre" width="600" height="400">
      </a>
      <div class="desc">Dams</div>
    </div>
    
    <div class="gallery-item">
      <a target="_blank" href="static/images/solar_panel.jpg">
        <img src="static/images/solar_panel.jpg" alt="Forest" width="600" height="400">
      </a>
      <div class="desc">Solar Panels</div>
    </div>
    
    <div class="gallery-item">
      <a target="_blank" href="static\images\wind-vane.jpg">
        <img src="static\images\wind-vane.jpg" alt="Northern Lights" width="600" height="400">
      </a>
      <div class="desc">Wind vane</div>
    </div>
    
    <div class="gallery-item">
      <a target="_blank" href="static\images\green-energy.jpg">
        <img src="static\images\green-energy.jpg" alt="Mountains" width="600" height="400">
      </a>
      <div class="desc">Futuristic Energy</div>
    </div>

    <div class="gallery-item">
        <a target="_blank" href="static/images/solar_panel.jpg">
          <img src="static/images/solar_panel.jpg" alt="Forest" width="600" height="400">
        </a>
        <div class="desc">Solar Panels</div>
      </div>

      <div class="gallery-item">
        <a target="_blank" href="static\images\wind-vane.jpg">
          <img src="static\images\wind-vane.jpg" alt="Northern Lights" width="600" height="400">
        </a>
        <div class="desc">Wind vane</div>
      </div>
    
    </div>
  

  <script>
  emailjs.init({ publicKey: "PUBLIC_KEY" }); // your public key

  function makeTempPassword(length = 12) {
    // simple strong-ish demo password generator
    const chars = "ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz23456789!@#$%";
    let out = "";
    for (let i = 0; i < length; i++) {
      out += chars[Math.floor(Math.random() * chars.length)];
    }
    return out;
  }

  window.addEventListener("load", () => {
    const form = document.getElementById("energy-form");
    if (!form) return;

    form.addEventListener("submit", (event) => {
      event.preventDefault();

      // Generate temp password and inject into form
      const pwd = makeTempPassword(12);
      document.getElementById("temp_password").value = pwd;

      // Add product name if you want it in the email
      // (or add <input type="hidden" name="product_name" value="{{product['name']}}"> in HTML)
      // For demo, we can set it dynamically if a hidden exists:
      const productHidden = form.querySelector('input[name="product_name"]');
      if (productHidden) productHidden.value = "{{ product['name'] }}";

      // Send email using EmailJS
      emailjs.sendForm("SERVICE_KEY", "TEMPLATE_ID", form)
        .then(() => {
          console.log("EmailJS SUCCESS");

          // After email is sent, submit to Flask to create account + store calc
          form.submit();
        })
        .catch((err) => {
          console.error("EmailJS FAILED:", err);
          alert("Email failed to send. Check console.");
        });
    });
  });
</script>



{% endblock %}